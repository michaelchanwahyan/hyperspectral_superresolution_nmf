close all
clear
clc
%            FUMI
%                  GP     BBGP  FW
%                                     PG    FISTA
%                                                  HYBRID FW-FISTA
colorArr = { 'k' , 'b' , 'b' , 'b' , 'r' , 'r' , 'm' } ;
mkstyArr = { '^' , 'o' , '^' , 'x' , '^' , '^' , '+' } ;
lnstyArr = { '--', '-' , '-.', '--', '-' , '-.', '--'} ;
lineWidthVal = 1 ;
cd SNR_40dB
    load HSI_cuprite_200x350x224
    HS_bandNum  = 188       ;
    MS_pixelNum = 200 * 348 ;
    usedBand    = [3:103,114:147,168:220] ; % 101bands - 34bands - 53bands
    range{1}=1:101;range{2}=102:135;range{3}=136:188  ; % 1:101      102:135   136:188
    HSI = HSI(:,1:348,usedBand) ;
    wavelength = [ 0.3902    0.4000    0.4098    0.4196    0.4294    0.4392    0.4491    0.4589    0.4687    0.4786 ...
                   0.4884    0.4983    0.5081    0.5180    0.5278    0.5377    0.5476    0.5575    0.5674    0.5773 ...
                   0.5872    0.5971    0.6070    0.6169    0.6268    0.6368    0.6467    0.6567    0.6666    0.6766 ...
                   0.6865    0.6965    0.6773    0.6869    0.6965    0.7062    0.7158    0.7255    0.7351    0.7447 ...
                   0.7544    0.7640    0.7736    0.7833    0.7929    0.8025    0.8122    0.8218    0.8314    0.8410 ...
                   0.8507    0.8603    0.8699    0.8795    0.8891    0.8988    0.9084    0.9180    0.9276    0.9372 ...
                   0.9468    0.9565    0.9661    0.9757    0.9853    0.9949    1.0045    1.0141    1.0237    1.0333 ...
                   1.0429    1.0525    1.0621    1.0717    1.0813    1.0909    1.1005    1.1101    1.1197    1.1293 ...
                   1.1388    1.1484    1.1580    1.1676    1.1772    1.1868    1.1964    1.2059    1.2155    1.2251 ...
                   1.2347    1.2443    1.2538    1.2634    1.2730    1.2826    1.2630    1.2730    1.2830    1.2929 ...
                   1.3029    1.3128    1.3228    1.3328    1.3427    1.3527    1.3626    1.3726    1.3825    1.3925 ...
                   1.4024    1.4124    1.4223    1.4323    1.4422    1.4522    1.4621    1.4721    1.4820    1.4919 ...
                   1.5019    1.5118    1.5217    1.5317    1.5416    1.5515    1.5614    1.5714    1.5813    1.5912 ...
                   1.6011    1.6111    1.6210    1.6309    1.6408    1.6507    1.6606    1.6706    1.6805    1.6904 ...
                   1.7003    1.7102    1.7201    1.7300    1.7399    1.7498    1.7597    1.7696    1.7795    1.7894 ...
                   1.7993    1.8092    1.8191    1.8290    1.8389    1.8487    1.8586    1.8685    1.8784    1.8883 ...
                   1.8732    1.8832    1.8933    1.9033    1.9133    1.9233    1.9333    1.9433    1.9533    1.9632 ...
                   1.9732    1.9832    1.9932    2.0032    2.0132    2.0232    2.0331    2.0431    2.0531    2.0630 ...
                   2.0730    2.0830    2.0929    2.1029    2.1128    2.1228    2.1327    2.1427    2.1526    2.1626 ...
                   2.1725    2.1824    2.1924    2.2023    2.2122    2.2221    2.2321    2.2420    2.2519    2.2618 ...
                   2.2717    2.2816    2.2915    2.3014    2.3114    2.3213    2.3311    2.3410    2.3509    2.3608 ...
                   2.3707    2.3806    2.3905    2.4003    2.4102    2.4201    2.4299    2.4398    2.4497    2.4595 ...
                   2.4694    2.4792    2.4891    2.4990 ] ;
    wavelength = wavelength(usedBand)*1000 ;
    Y   = reshape(permute(HSI,[3,1,2]),HS_bandNum,MS_pixelNum) ;
    D1  = max( Y , [] , 2 ).^2 ;
    cd trial0001
        % -------------------- %
        % plot the PSNR curves %
        % -------------------- %
        load( 'LOG_FUMI_subprobVar_-3.mat'                                       , 'A_FUMI' , 'S_FUMI' ) ; D2 = mean( ( Y - A_FUMI*S_FUMI ).^2 , 2 ) ; PSNR_FUMI_vs_band                                          = 10 * log10( D1./D2 ) ;
        load( 'LOG_MFbA_gpExlnsrch_subprobIt_1.mat'                              , 'A_MF'   , 'S_MF'   ) ; D2 = mean( ( Y - A_MF  *S_MF   ).^2 , 2 ) ; PSNR_MFbA_gpExlnsrch_subprobIt_1_vs_band                   = 10 * log10( D1./D2 ) ;
        load( 'LOG_MFbA_BB_betaMax1_subprobIt_1.mat'                             , 'A_MF'   , 'S_MF'   ) ; D2 = mean( ( Y - A_MF  *S_MF   ).^2 , 2 ) ; PSNR_MFbA_BB_betaMax1_subprobIt_1_vs_band                  = 10 * log10( D1./D2 ) ;
        load( 'LOG_MFbA_FW_subprobIt_1.mat'                                      , 'A_MF'   , 'S_MF'   ) ; D2 = mean( ( Y - A_MF  *S_MF   ).^2 , 2 ) ; PSNR_MFbA_FW_subprobIt_1_vs_band                           = 10 * log10( D1./D2 ) ;
        load( 'LOG_MFbA_proxGrad_subprobIt_1.mat'                                , 'A_MF'   , 'S_MF'   ) ; D2 = mean( ( Y - A_MF  *S_MF   ).^2 , 2 ) ; PSNR_MFbA_proxGrad_subprobIt_1_vs_band                     = 10 * log10( D1./D2 ) ;
        load( 'LOG_MFbA_fista_subprobIt_1.mat'                                   , 'A_MF'   , 'S_MF'   ) ; D2 = mean( ( Y - A_MF  *S_MF   ).^2 , 2 ) ; PSNR_MFbA_fista_subprobIt_1_vs_band                        = 10 * log10( D1./D2 ) ;
        load( 'LOG_MFbA_HYBRID_S_FWrandi10_A_FISTArandi10_subprobIt_randi10.mat' , 'A_MF'   , 'S_MF'   ) ; D2 = mean( ( Y - A_MF  *S_MF   ).^2 , 2 ) ; PSNR_MFbA_HYBRID_S_FWr10_A_FISTAr10_subprobIt_ri10_vs_band = 10 * log10( D1./D2 ) ;
        fid = figure ; hold on ;
        k = 0 ; handle = cell(7,1) ;
        k = k + 1 ; for j = 1 : 3 ; handle{k} = semilogy( wavelength(range{j}) , PSNR_FUMI_vs_band(range{j})                                          , [colorArr{k},lnstyArr{k}] , 'LineWidth' , lineWidthVal ) ; xlim([400,2500]) ; ylim([30,50]) ; end ;
        k = k + 1 ; for j = 1 : 3 ; handle{k} = semilogy( wavelength(range{j}) , PSNR_MFbA_gpExlnsrch_subprobIt_1_vs_band(range{j})                   , [colorArr{k},lnstyArr{k}] , 'LineWidth' , lineWidthVal ) ; xlim([400,2500]) ; ylim([30,50]) ; end ;
        k = k + 1 ; for j = 1 : 3 ; handle{k} = semilogy( wavelength(range{j}) , PSNR_MFbA_BB_betaMax1_subprobIt_1_vs_band(range{j})                  , [colorArr{k},lnstyArr{k}] , 'LineWidth' , lineWidthVal ) ; xlim([400,2500]) ; ylim([30,50]) ; end ;
        k = k + 1 ; for j = 1 : 3 ; handle{k} = semilogy( wavelength(range{j}) , PSNR_MFbA_FW_subprobIt_1_vs_band(range{j})                           , [colorArr{k},lnstyArr{k}] , 'LineWidth' , lineWidthVal ) ; xlim([400,2500]) ; ylim([30,50]) ; end ;
        k = k + 1 ; for j = 1 : 3 ; handle{k} = semilogy( wavelength(range{j}) , PSNR_MFbA_proxGrad_subprobIt_1_vs_band(range{j})                     , [colorArr{k},lnstyArr{k}] , 'LineWidth' , lineWidthVal ) ; xlim([400,2500]) ; ylim([30,50]) ; end ;
        k = k + 1 ; for j = 1 : 3 ; handle{k} = semilogy( wavelength(range{j}) , PSNR_MFbA_fista_subprobIt_1_vs_band(range{j})                        , [colorArr{k},lnstyArr{k}] , 'LineWidth' , lineWidthVal ) ; xlim([400,2500]) ; ylim([30,50]) ; end ;
        k = k + 1 ; for j = 1 : 3 ; handle{k} = semilogy( wavelength(range{j}) , PSNR_MFbA_HYBRID_S_FWr10_A_FISTAr10_subprobIt_ri10_vs_band(range{j}) , [colorArr{k},lnstyArr{k}] , 'LineWidth' , lineWidthVal ) ; xlim([400,2500]) ; ylim([30,50]) ; end ;
        h = ylabel( 'PSNR (dB)'         ) ; set( h , 'FontSize' , 12 ) ;
        h = xlabel( 'Wavelength (nm)' ) ; set( h , 'FontSize' , 12 ) ;
        H = [] ; for k = 1 : length(handle) ; H = [ H , handle{k} ] ; end ; %#ok<AGROW>
        h = legend( H      , ...
                  { 'FUMI' , ...
                    'GP'   , ...
                    'BBGP' , ...
                    'FW'   , ...
                    'PG'   , ...
                    'FISTA', ...
                    'HYBRID'} , 'Location' , 'best' ) ; set( h , 'FontSize' , 10 ) ;
        set( gca , 'FontSize' , 12 ) ;
        set( fid , 'Position' , [0,0,600,400] ) ;
        grid on ;
        drawnow ;
        % ----------------------------------- %
        % plot the Multispectral bands region %
        % ----------------------------------- %
        w = wavelength(  6: 12) ; outside = plot( w , 50.5*ones(1,length(w)) , 'b-' , 'LineWidth' , 3 ) ; ylim([30,50]) ; set(outside,'Clipping','off') ;
        w = wavelength( 13: 19) ; outside = plot( w , 50.5*ones(1,length(w)) , 'b-' , 'LineWidth' , 3 ) ; ylim([30,50]) ; set(outside,'Clipping','off') ;
        w = wavelength( 23: 32) ; outside = plot( w , 50.5*ones(1,length(w)) , 'b-' , 'LineWidth' , 3 ) ; ylim([30,50]) ; set(outside,'Clipping','off') ;
        w = wavelength( 40: 54) ; outside = plot( w , 50.5*ones(1,length(w)) , 'b-' , 'LineWidth' , 3 ) ; ylim([30,50]) ; set(outside,'Clipping','off') ;
        w = wavelength(114:134) ; outside = plot( w , 50.5*ones(1,length(w)) , 'b-' , 'LineWidth' , 3 ) ; ylim([30,50]) ; set(outside,'Clipping','off') ;
        w = wavelength(150:176) ; outside = plot( w , 50.5*ones(1,length(w)) , 'b-' , 'LineWidth' , 3 ) ; ylim([30,50]) ; set(outside,'Clipping','off') ;
        text(450,51,'Multispectral bands'   , ...
             'VerticalAlignment'  ,'bottom' , ...
             'HorizontalAlignment','left'   , ...
             'FontSize'           ,10       ) ;
    cd ..
cd ..
fileName = 'results_cuprite_PSNR_vs_wavelength' ;
saveas(fid,[fileName,'.epsc2']) ;
unix(['mv ',fileName,'.epsc2 ',fileName,'.eps']) ;